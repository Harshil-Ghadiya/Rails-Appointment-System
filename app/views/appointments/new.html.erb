<%= turbo_frame_tag "main_content" do %>

  <div style="max-width: 600px; margin: 50px auto; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    <div style="background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid #e0e0e0;">
      
 <%# Notice Before a Book Appointment  %>

      <% if @notices.any? %>
  <div class="notices-container" style="margin-bottom: 25px;">
    <% @notices.each do |notice| %>
      <div style="background: #fff3cd; border-left: 5px solid #ffc107; padding: 15px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
        <div style="display: flex; align-items: center; gap: 10px;">
          <span style="font-size: 20px;">ðŸ“¢</span>
          <div>
            <p style="margin: 5px 0 0; color: #664d03; font-size: 14px;"><%= notice.content %></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>

      <div style="text-align: center; margin-bottom: 30px;">
        <h2 style="color: #2c3e50; margin-bottom: 10px;">Book Appointment</h2>
        <p style="color: #7f8c8d;">Register yourself for <strong><%= @organization.name %></strong></p>
        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
      </div>

      <%= form_with(model: @appointment, local: true) do |f| %>
        <%# --- HIDDEN FIELD --- %>
        <%= f.hidden_field :organization_id, value: @organization.id %>

        <%# --- 1. PATIENT NAME --- %>
        <% if @organization.field_settings.find_by(field_name: 'patient_name')&.is_required %>
          <div style="margin-bottom: 20px;">
            <%= f.label :patient_name, "Full Name", style: "display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;" %>
            <%= f.text_field :patient_name, placeholder: "Enter your full name", required: true, 
                style: "width: 100%; padding: 12px; border: 1px solid #dcdde1; border-radius: 8px; box-sizing: border-box; font-size: 16px;" %>
          </div>
        <% end %>
        
        <%# --- 2. PATIENT PHONE --- %>

    <% if @organization.field_settings.find_by(field_name: 'patient_email')&.is_required %>
          <div style="margin-bottom: 20px;">
            <%= f.label :patient_email, "Email Address (Optional)", style: "display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;" %>
            <%= f.email_field :patient_email, placeholder: "email@example.com", 
                style: "width: 100%; padding: 12px; border: 1px solid #dcdde1; border-radius: 8px; box-sizing: border-box; font-size: 16px;" %>
          </div>
        <% end %>


        <% if @organization.field_settings.find_by(field_name: 'patient_phone')&.is_required %>
          <div style="margin-bottom: 20px;">
            <%= f.label :patient_phone, "Phone Number", style: "display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;" %>
            <%= f.telephone_field :patient_phone, placeholder: "Enter 10 digit mobile number", required: true, 
                style: "width: 100%; padding: 12px; border: 1px solid #dcdde1; border-radius: 8px; box-sizing: border-box; font-size: 16px;" %>
          </div>
        <% end %>

        <%# --- 3. PATIENT EMAIL --- %>
    

        <%# --- 4. PATIENT ADDRESS --- %>
        <% if @organization.field_settings.find_by(field_name: 'patient_address')&.is_required %>
          <div style="margin-bottom: 30px;">
            <%= f.label :patient_address, "Address", style: "display: block; margin-bottom: 8px; font-weight: 600; color: #34495e;" %>
            <%= f.text_area :patient_address, rows: 3, placeholder: "Enter your city or area", 
                style: "width: 100%; padding: 12px; border: 1px solid #dcdde1; border-radius: 8px; box-sizing: border-box; font-size: 16px; resize: vertical;" %>
          </div>
        <% end %>

        <div style="text-align: center;">
          <%= f.submit "Create Appointment", 
              style: "background: #27ae60; color: white; padding: 15px 40px; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; width: 100%; box-shadow: 0 4px 15px rgba(39,174,96,0.3);" %>
          <%= link_to "Cancel", :back, style: "display: inline-block; margin-top: 20px; color: #7f8c8d; text-decoration: none; font-size: 14px;" %>
        </div>
      <% end %> 

    </div>
  </div>
<% end %>