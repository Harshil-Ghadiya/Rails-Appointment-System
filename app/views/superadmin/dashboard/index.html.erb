<h1>All Organization List </h1>

<div class="dashboard-header" style="display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #f4f4f4;">
  <h2>Super Admin Dashboard</h2>
  
  
  <div class="header-actions">
    <%# Aa Logout button khali ahiya j dekhase %>
    <%= button_to "Logout Super Admin", destroy_user_session_path, 
                  method: :delete, 
                  data: { turbo: false },
                  class: "btn-danger",
                  style: "background-color: #dc3545; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer;" %>
  </div>
</div>

<hr>
<table class="org-table" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
  <thead>
    <tr style="background: #333; color: white;">
      <th style="padding: 12px;">Name</th>
      <th style="padding: 12px;">Admin Email</th>
      <th style="padding: 12px;">Status</th>
      <th style="padding: 12px;">Toggle Action</th>
      <th style="padding: 12px;">Sign In As a Admin</th>
    </tr>
  </thead>
  <tbody>
    <% @organizations.each do |org| %>
      <tr style="border-bottom: 1px solid #ddd; text-align: center;">
        <td style="padding: 10px;"><%= org.name %></td>
        <td style="padding: 10px;"><%= org.email %></td>
        <td style="padding: 10px;">
          <span id="status-badge-<%= org.id %>" class="badge <%= org.is_approved ? 'status-active' : 'status-pending' %>">
            <%= org.is_approved ? "Active" : "Inactive" %>
          </span>
        </td>
        <td style="padding: 10px;">
          <%# Toggle Switch UI %>
          <label class="switch">
            <%# Switch click thase tyare automatic sachi method call thase %>
            <%= button_to (org.is_approved ? superadmin_inactive_organization_path(org) : superadmin_approve_organization_path(org)), 
                method: :patch, 
                form: { style: 'display:inline;' },
                class: "toggle-btn-overlay" do %>
              <input type="checkbox" <%= org.is_approved ? 'checked' : '' %> disabled>
              <span class="slider round"></span>
            <% end %>
          </label>
        </td>

<td style="padding: 10px;">
  <% if org.is_approved %>
    <%= button_to "ðŸ”‘ Login as Admin", 
        superadmin_login_as_admin_path(org), 
        method: :post, 
        data: { turbo: false },
        style: "background: #8e44ad; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: bold;" %>
  <% else %>
    <span style="color: #95a5a6; font-size: 11px;">Approve first</span>
  <% end %>
</td>
      </tr>
    <% end %>
  </tbody>
</table>


<%# Aaj no samay set karvo logic mate %>
<% today_range = Time.zone.now.beginning_of_day..Time.zone.now.end_of_day %>

<div style="margin-top: 30px; margin-bottom: 20px;">
  <h3 style="color: #2c3e50; border-left: 5px solid #3498db; padding-left: 15px;">ðŸ“Š Today's Live Check total Appointments </h3>
</div>

<div style="display: flex; gap: 20px; margin-bottom: 30px;">
  
  <%# --- Completed Card --- %>
  <div style="flex: 1; background: #ebfbee; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #c3e6cb; text-align: center;">
    <h4 style="margin: 0; color: #2ecc71; font-size: 13px; text-transform: uppercase;">Completed Appointment</h4>
    <p style="margin: 10px 0 0 0; font-size: 36px; font-weight: 800; color: #155724;">
      <%= Appointment.where(status: 'completed', created_at: today_range).count %>
    </p>
  </div>

  <%# --- Skipped Card --- %>
  <div style="flex: 1; background: #fff9db; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #ffeeba; text-align: center;">
    <h4 style="margin: 0; color: #f39c12; font-size: 13px; text-transform: uppercase;">Skipped Appointment</h4>
    <p style="margin: 10px 0 0 0; font-size: 36px; font-weight: 800; color: #856404;">
      <%= Appointment.where(status: 'skipped', created_at: today_range).count %>
    </p>
  </div>

  <%# --- Deleted Card --- %>
  <div style="flex: 1; background: #fff5f5; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #f5c6cb; text-align: center;">
    <h4 style="margin: 0; color: #e74c3c; font-size: 13px; text-transform: uppercase;">Deleted appointment</h4>
    <p style="margin: 10px 0 0 0; font-size: 36px; font-weight: 800; color: #721c24;">
      <%= Appointment.where(status: 'deleted', created_at: today_range).count %>
    </p>
  </div>

</div>