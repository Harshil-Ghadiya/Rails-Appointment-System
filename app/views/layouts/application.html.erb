<!DOCTYPE html>
<html>
  <head>
    <meta name="turbo-cache-control" content="no-cache">
    <title><%= content_for(:title) || "Myapp" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= yield :head %>
    <%= javascript_importmap_tags %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  </head>

  <body style="margin: 0; background: #f4f7f6;">
    
    <%# --- GLOBAL FLASH CONTAINER: Aa hamesha ahiya rahese --- %>
    <div id="flash-container" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
      <%= render 'layouts/flash' %>
    </div>

    <div class="app-container" style="display: flex; min-height: 100vh;">
      
      <% if current_user && request.path.include?('/admin') %>
        
        <div style="width: 250px; flex-shrink: 0;">
          <%= render 'admin/shared/sidebar' %>
        </div>

        <main style="flex-grow: 1;">
          <%= turbo_frame_tag "main_content", data: { turbo_action: "advance" } do %>
            <%= yield %>
          <% end %>
        </main>

      <% else %>
        
        <main style="flex-grow: 1; width: 100%;">
          <%= yield %>
        </main>

      <% end %>

    </div>
  </body>
</html>